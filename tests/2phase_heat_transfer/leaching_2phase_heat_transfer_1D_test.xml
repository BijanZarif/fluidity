<?xml version='1.0' encoding='utf-8'?>
<testproblem>
  <name>leaching_2phase_heat_transfer_1D_test</name>
  <owner userid="LCai"/>
  <problem_definition length="short" nprocs="1">
    <command_line>make input;
darcy_impes leaching_2phase_heat_transfer_1D_test.diml;</command_line>
  </problem_definition>
  <variables>
    <variable name="data" language="python">import fluidity.diagnostics.fluiditytools as fluidity_tools

rst=fluidity_tools.stat_parser('./leaching_2phase_heat_transfer_1D_test.stat')

#rock phase
es_norm=rst['Phase1']['ETr'][u'l2norm']
es_max=rst['Phase1']['ETr'][u'max']
es_min=rst['Phase1']['ETr'][u'min']
hs_m=rst['Phase1']['mineral_dissolution_heat_sources'][u'l2norm']
hs_t=rst['Phase1']['solid_liquid_heat_transfer_rock_phase'][u'l2norm']

#liquid phase
el_norm=rst['Phase2']['ETl'][u'l2norm']
el_max=rst['Phase2']['ETl'][u'max']
el_min=rst['Phase2']['ETl'][u'min']
hl_m=rst['Phase2']['solution_phase_heat_sources'][u'l2norm']
hl_t=rst['Phase2']['solid_liquid_heat_transfer_liquid_phase'][u'l2norm']

data={'es_norm':es_norm,'es_max':es_max,'es_min':es_min,'hs_m':hs_m,'hs_t':hs_t,'el_norm':el_norm,'el_max':el_max,'el_min':el_min,'hl_m':hl_m,'hl_t':hl_t}</variable>
    <variable name="solvers_converged" language="python">import os
files = os.listdir("./")
solvers_converged = not "matrixdump" in files and not "matrixdump.info" in files</variable>
  </variables>
  <pass_tests>
    <test name="Solvers_converged" language="python">assert(solvers_converged)</test>
    <test name="bound" language="python">import fluidity_tools

fluidity_tools.compare_variable(0.0047541438130633265,max(data['es_norm']), 1.0e-13)
fluidity_tools.compare_variable(0.00023934956470839097,max(data['es_max']), 1.0e-13)
fluidity_tools.compare_variable(0.0002341747390346427,max(data['es_min']), 1.0e-13)
fluidity_tools.compare_variable(9.6449362770422161e-07,max(data['hs_m']), 1.0e-13)
fluidity_tools.compare_variable(0.0033883300949156367,min(data['hs_t']), 1.0e-13)
fluidity_tools.compare_variable(0.0034647613123919055,max(data['hs_t']), 1.0e-13)

fluidity_tools.compare_variable(0.01967163078276617,max(data['el_norm']), 1.0e-13)
fluidity_tools.compare_variable(0.0012724459754736017,max(data['el_max']), 1.0e-13)
fluidity_tools.compare_variable(0.00093399571238705903,max(data['el_min']), 1.0e-13)
fluidity_tools.compare_variable(0.0,max(data['hl_m']), 1.0e-13)
fluidity_tools.compare_variable(0.0012782872287207668,min(data['hl_t']), 1.0e-13)
fluidity_tools.compare_variable(0.0013071218010436043,max(data['hl_t']), 1.0e-13)</test>
  </pass_tests>
</testproblem>
